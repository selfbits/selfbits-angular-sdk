!function(e){e.module("selfbitsAngular",["ngResource","ngSanitize"]).run(function(e,n,t){e.domain||n.error('Selfbits SDK: you MUST set $sbApiProvider.domain="yourDomain"'),e.id||n.error('Selfbits SDK: you MUST set $sbApiProvider.appId="yourId"'),e.id&&e.domain||n.error("If you don't have a Selfbits account yet, you can get one at http://baas.selfbits.org"),t.load()})}(angular),function(e){e.module("selfbitsAngular").constant("sbConfig",{id:null,domain:null,secret:null})}(angular),function(e){function n(e,n){Object.defineProperties(this,{domain:{get:function(){return n.domain},set:function(e){n.domain=e}},appId:{get:function(){return n.id},set:function(t){n.id=t,e.defaults.headers.common["SB-App-Id"]=t}},appSecret:{get:function(){return n.secret},set:function(t){t?(n.secret=t,e.defaults.headers.common["SB-App-Secret"]=t):n.secret=null}}}),this.$get=function(){}}e.module("selfbitsAngular").provider("$sbApi",n)}(angular),function(e){function n(e,n,t,o,i,r,a,u,s,c){function f(t){var r,f=new o.defer,l=i.gen()+i.gen(),p=e.domain+"/api/v1/oauth/"+t+"?sb_app_id="+e.id+"&sb_app_secret="+e.secret+"&state="+l;if(a.cordova&&a.cordova.InAppBrowser)r=a.cordova.InAppBrowser.open(p,"_blank","location=no"),r.addEventListener("loadstop",function(e){e.url.indexOf(t+"/callback")>-1&&r.close()}),r.addEventListener("loaderror",function(e){e.url.indexOf(t+"/callback")>-1&&r.close()}),r.addEventListener("exit",function(){s(function(){d(t,l).then(function(e){n.setToken(e.data.token),n.setUserId(e.data.userId),c.sync().then(function(){f.resolve(e.data)},function(e){f.reject(e)})},function(e){f.reject(e)})},500)});else{r=a.open(p,"_blank","height=700, width=500");var v=u(function(){r.closed&&(d(t,l).then(function(e){n.setUserId(e.data.userId),n.setToken(e.data.token),f.resolve(e.data)},function(e){f.reject(e)}),u.cancel(v))},1e3)}return f.promise}function d(n,t){return r.get(e.domain+"/api/v1/oauth/"+n+"/token?state="+t)}function l(n){var t=new o.defer;return r["delete"](e.domain+"/api/v1/oauth/"+n+"/unlink").then(function(e){t.resolve(e.data)},function(e){t.reject(e)}),t.promise}function p(n,t){var i=new o.defer;return r.post(e.domain+"/api/v1/auth/password",{newPassword:n,oldPassword:t}).then(function(e){i.resolve(e.data)},function(e){i.reject(e)}),i.promise}function v(t){var i=new o.defer;return r.post(e.domain+"/api/v1/auth/login",t).then(function(e){n.setToken(e.data.token),n.setUserId(e.data.userId),c.sync().then(function(){i.resolve(e.data)},function(e){i.reject(e)})},function(e){i.reject(e)}),i.promise}function g(t){var i=new o.defer;return r.post(e.domain+"/api/v1/auth/signup",t).then(function(e){n.setToken(e.data.token),n.setUserId(e.data.userId),c.sync().then(function(){i.resolve(e.data)},function(e){i.reject(e)})},function(e){i.reject(e)}),i.promise}function m(){var t=new o.defer;return r.post(e.domain+"/api/v1/auth/signup/anonymous").then(function(e){n.setToken(e.data.token),n.setUserId(e.data.userId),c.sync().then(function(){t.resolve(e.data)},function(e){t.reject(e)})},function(e){t.reject(e)}),t.promise}function h(){n.clear()}function b(){return n.getUserId()}function I(){return null!==n.getToken()}var j={social:f,unlink:l,login:v,signup:g,signupAnonymous:m,logout:h,password:p,getUserId:b,isAuthenticated:I};return j}e.module("selfbitsAngular").factory("$sbAuth",n)}(angular),function(e){function n(e,n){function t(t){return n(e.domain+"/api/v1/db/m/"+t+"/:_id",{_id:"@_id"},{update:{method:"PUT"}})}var o={table:t};return o}e.module("selfbitsAngular").factory("$sbDatabase",n)}(angular),function(e){function n(e,n,t,o){function i(){var i=new n.defer;return t.cordova&&t.device?o.post(e.domain+"/api/v1/user/device",t.device).then(function(e){i.resolve(e)},function(e){i.reject(e)}):i.resolve(),i.promise}var r={sync:i};return r}e.module("selfbitsAngular").factory("sbDevice",n)}(angular),function(e){function n(e,n,t,o,i,r,a){function u(t){var o=n.defer();if(t.fileId){var i={};t.expiresInSeconds&&(i.expiresInSeconds=t.expiresInSeconds),e.get(r.domain+"/api/v1/file/"+t.fileId,{params:i}).then(function(e){o.resolve(e.data)},function(e){o.reject(e)})}else o.reject({message:"Missing fileId!"});return o.promise}function s(e){var t=n.defer(),o=e.file,i=null;return c(e).then(function(e){return i=e,f(i.putFileUrl,o)}).then(function(e){var n=e.headers("ETag");return d(i.fileId,n)}).then(function(e){t.resolve(e)})["catch"](function(e){t.reject(e)}),t.promise}function c(t){var o=n.defer();if(t&&t.file){var i=(t.file,{filePath:t.filePath||t.file.name,permissionScope:t.permissionScope||"user"});e.post(r.domain+"/api/v1/file",i).then(function(e){o.resolve(e.data)},function(e){o.reject(e)})}else o.reject({message:"Upload initialization failed! Missing file param!"});return o.promise}function f(t,o){var i=n.defer();return t&&o?e({method:"PUT",url:t,headers:{"Content-Type":o.type?o.type:"application/octet-stream",Authorization:void 0,"SB-App-Id":void 0,"SB-App-Secret":void 0},data:o}).then(function(e){i.resolve(e)},function(e){i.reject({message:"Upload failed! Please try again!"})}):i.reject(),i.promise}function d(t,o){var i=n.defer();if(t)if(o){var a={etag:o};e.post(r.domain+"/api/v1/file/"+t+"/verify",a).then(function(e){i.resolve(e.data)},function(e){i.reject(e)})}else i.reject({message:"Upload verification failed! Missing etag!"});else i.reject({message:"Upload verification failed! Missing fileId!"});return i.promise}var l={get:u,upload:s,initiateUpload:c,executeUpload:f,verifyUpload:d};return l}e.module("selfbitsAngular").factory("$sbFile",n)}(angular),function(e){function n(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function n(){return e()+e()+e()+e()+e()+e()+e()+e()}var t={gen:n};return t}e.module("selfbitsAngular").factory("sbGuid",n)}(angular),function(e){function n(e,n,t,o,i,r,a){function u(){return t.device&&t.device.uuid&&t.PushNotification&&l.pushRegistrationData&&l.pushRegistrationData.registrationId?e.post(r.domain+"/api/v1/user/device/notification",{uuid:t.device.uuid,deviceToken:l.pushRegistrationData.registrationId}):void 0}function s(e){t.PushNotification&&(l.push=t.PushNotification.init(e),l.push.on("registration",function(e){l.pushRegistrationData=e}),l.push.on("notification",function(e){o.$broadcast("pushNotificationReceived",e)}),l.push.on("error",function(e){a.log(e)}))}function c(e){var o=n.defer();return t.PushNotification?t.PushNotification.unregister(function(e){o.resolve(e)},function(e){o.reject(e)},e):o.reject(new Error("Missing cordova environment")),o.promise}function f(e){var o=n.defer();return t.PushNotification?t.PushNotification.setApplicationIconBadgeNumber(function(e){o.resolve(e)},function(e){o.reject(e)},e):o.reject(new Error("Missing cordova environment")),o.promise}function d(){var e=n.defer();return t.PushNotification?t.PushNotification.clearAllNotifications(function(){e.resolve()},function(n){e.reject(n)}):e.reject(new Error("Missing cordova environment")),e.promise}var l={push:null,pushRegistrationData:null,sync:u,init:s,unregister:c,setBadgeNumber:f,clearAllNotifications:d};return l}e.module("selfbitsAngular").factory("$sbPush",n)}(angular),function(e){function n(e,n){function t(t){t&&(e.localStorage.setItem("sb_token",t),n.defaults.headers.common.Authorization="Bearer "+t)}function o(n){n&&e.localStorage.setItem("userId",n)}function i(){return e.localStorage.getItem("userId")}function r(){return e.localStorage.getItem("sb_token")}function a(){var t=e.localStorage.getItem("sb_token");t&&(n.defaults.headers.common.Authorization="Bearer "+t)}function u(){n.defaults.headers.common.Authorization=void 0,e.localStorage.clear()}var s={setToken:t,setUserId:o,getToken:r,getUserId:i,load:a,clear:u};return s}e.module("selfbitsAngular").factory("sbState",n)}(angular),function(e){function n(e,n,t,o){function i(){var t=new n.defer;return o.get(e.domain+"/api/v1/user").then(function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise}var r={current:i};return r}e.module("selfbitsAngular").factory("$sbUser",n)}(angular);